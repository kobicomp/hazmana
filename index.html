<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ניהול טפסי הזמנות</title>
    <style>
        :root {
            --primary-color: #2196F3;
            --success-color: #4CAF50;
            --danger-color: #f44336;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background-color: var(--primary-color);
            color: white;
            margin: 5px;
        }

        button:hover {
            opacity: 0.9;
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
        }

        .preview {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ניהול טופס הזמנות</h1>
        
        <form id="admin-form">
            <div class="form-group">
                <label for="form-title">כותרת הטופס:</label>
                <input type="text" id="form-title" required>
            </div>

            <div class="form-group">
                <label>תאריכים זמינים:</label>
                <div id="dates-container"></div>
                <button type="button" class="add-button" onclick="addDate()">הוסף תאריך</button>
            </div>

            <div class="form-group">
                <label for="time-interval">הפרש זמן בין תורים (בדקות):</label>
                <select id="time-interval">
                    <option value="5">5 דקות</option>
                    <option value="10">10 דקות</option>
                    <option value="15" selected>15 דקות</option>
                    <option value="20">20 דקות</option>
                    <option value="30">30 דקות</option>
                    <option value="60">שעה</option>
                </select>
            </div>

            <div class="form-group">
                <label>שעות פעילות:</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <div>
                        <label for="start-time">התחלה:</label>
                        <input type="time" id="start-time" value="16:00" required>
                    </div>
                    <div>
                        <label for="end-time">סיום:</label>
                        <input type="time" id="end-time" value="20:00" required>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <button type="submit">שמור הגדרות</button>
                <button type="button" onclick="openBookingPage()">פתח דף הזמנות</button>
            </div>
        </form>

        <div id="status-message" class="status" style="display: none;"></div>

        <div class="preview">
            <h3>תצוגה מקדימה:</h3>
            <div id="preview-content"></div>
        </div>
    </div>

    <script>
        function addDate() {
            const container = document.getElementById('dates-container');
            const dateWrapper = document.createElement('div');
            dateWrapper.style.display = 'flex';
            dateWrapper.style.gap = '10px';
            dateWrapper.style.marginBottom = '10px';

            const dateInput = document.createElement('input');
            dateInput.type = 'date';
            dateInput.required = true;
            dateInput.min = new Date().toISOString().split('T')[0];

            const removeButton = document.createElement('button');
            removeButton.type = 'button';
            removeButton.textContent = 'הסר';
            removeButton.style.backgroundColor = 'var(--danger-color)';
            removeButton.onclick = () => dateWrapper.remove();

            dateWrapper.appendChild(dateInput);
            dateWrapper.appendChild(removeButton);
            container.appendChild(dateWrapper);
        }

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('bookingSettings') || '{}');
            
            document.getElementById('form-title').value = settings.title || '';
            document.getElementById('time-interval').value = settings.timeInterval || '15';
            document.getElementById('start-time').value = settings.startTime || '16:00';
            document.getElementById('end-time').value = settings.endTime || '20:00';

            const container = document.getElementById('dates-container');
            container.innerHTML = '';
            
            if (settings.dates && settings.dates.length) {
                settings.dates.forEach(date => {
                    const dateWrapper = document.createElement('div');
                    dateWrapper.style.display = 'flex';
                    dateWrapper.style.gap = '10px';
                    dateWrapper.style.marginBottom = '10px';

                    const dateInput = document.createElement('input');
                    dateInput.type = 'date';
                    dateInput.required = true;
                    dateInput.value = date;
                    dateInput.min = new Date().toISOString().split('T')[0];

                    const removeButton = document.createElement('button');
                    removeButton.type = 'button';
                    removeButton.textContent = 'הסר';
                    removeButton.style.backgroundColor = 'var(--danger-color)';
                    removeButton.onclick = () => dateWrapper.remove();

                    dateWrapper.appendChild(dateInput);
                    dateWrapper.appendChild(removeButton);
                    container.appendChild(dateWrapper);
                });
            } else {
                addDate(); // הוספת תאריך ראשון כברירת מחדל
            }
        }

        function saveSettings(e) {
            e.preventDefault();

            const settings = {
                title: document.getElementById('form-title').value,
                timeInterval: document.getElementById('time-interval').value,
                startTime: document.getElementById('start-time').value,
                endTime: document.getElementById('end-time').value,
                dates: Array.from(document.querySelectorAll('#dates-container input[type="date"]'))
                    .map(input => input.value)
                    .filter(date => date)
            };

            localStorage.setItem('bookingSettings', JSON.stringify(settings));
            showStatus('ההגדרות נשמרו בהצלחה!', 'success');
            updatePreview(settings);
        }

        function showStatus(message, type) {
            const status = document.getElementById('status-message');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
            setTimeout(() => status.style.display = 'none', 3000);
        }

        function updatePreview(settings) {
            const preview = document.getElementById('preview-content');
            preview.innerHTML = `
                <strong>כותרת:</strong> ${settings.title}<br>
                <strong>תאריכים:</strong> ${settings.dates.map(d => new Date(d).toLocaleDateString('he-IL')).join(', ')}<br>
                <strong>הפרש זמן:</strong> ${settings.timeInterval} דקות<br>
                <strong>שעות פעילות:</strong> ${settings.startTime} - ${settings.endTime}
            `;
        }

        function openBookingPage() {
            window.open('index.html', '_blank');
        }

        // אתחול
        document.getElementById('admin-form').onsubmit = saveSettings;
        loadSettings();
    </script>
</body>
</html>
